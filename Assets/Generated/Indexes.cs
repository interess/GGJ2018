// <auto-generated>
//     This code was generated with love by Gentitas.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

using Entitas;
using System.Collections.Generic;

namespace DZ.Core.Indexes {
	namespace State {
        public interface ISceneNameIndex {
            /// Value: SceneName  
            StateEntity FindSingle(string value);
            /// Value: SceneName  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class SceneNameIndex : Entitas.Gentitas.Index<string, StateEntity>, ISceneNameIndex
        {
            IGroup<StateEntity> groupToWatch;

            public SceneNameIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.SceneName));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~SceneNameIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasSceneName() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasSceneName()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.SceneName)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.SceneName)component).value, ((Components.State.SceneName)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.SceneName)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Core.SceneNameIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
	}
}
namespace DZ.Game.Indexes {
	namespace Input {
	}
	namespace State {
        public interface IFactoryIdIndex {
            /// Value: FactoryId  
            StateEntity FindSingle(string value);
            /// Value: FactoryId  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class FactoryIdIndex : Entitas.Gentitas.Index<string, StateEntity>, IFactoryIdIndex
        {
            IGroup<StateEntity> groupToWatch;

            public FactoryIdIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.FactoryId));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~FactoryIdIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasFactoryId() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasFactoryId()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.FactoryId)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.FactoryId)component).value, ((Components.State.FactoryId)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.FactoryId)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.FactoryIdIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface ILevelIndexIndex {
            /// Value: LevelIndex  
            StateEntity FindSingle(int value);
            /// Value: LevelIndex  
            HashSet<StateEntity> Find(int value);
            int GetCount(int value);
        }

        public class LevelIndexIndex : Entitas.Gentitas.Index<int, StateEntity>, ILevelIndexIndex
        {
            IGroup<StateEntity> groupToWatch;

            public LevelIndexIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.LevelIndex));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~LevelIndexIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasLevelIndex() ;
            }

            void Remove(StateEntity entity, int value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, int value)
            {
                if (entity.HasLevelIndex()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, int value, int previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LevelIndex)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LevelIndex)component).value, ((Components.State.LevelIndex)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LevelIndex)component).value);
            }

            public StateEntity FindSingle(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.LevelIndexIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface IUidIndex {
            /// Value: Uid  
            StateEntity FindSingle(int value);
            /// Value: Uid  
            HashSet<StateEntity> Find(int value);
            int GetCount(int value);
        }

        public class UidIndex : Entitas.Gentitas.Index<int, StateEntity>, IUidIndex
        {
            IGroup<StateEntity> groupToWatch;

            public UidIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.Uid));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~UidIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasUid() ;
            }

            void Remove(StateEntity entity, int value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, int value)
            {
                if (entity.HasUid()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, int value, int previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Uid)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Uid)component).value, ((Components.State.Uid)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Uid)component).value);
            }

            public StateEntity FindSingle(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.UidIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface IChannelIndex {
            /// Value: Channel  
            StateEntity FindSingle(int value);
            /// Value: Channel  
            HashSet<StateEntity> Find(int value);
            int GetCount(int value);
        }

        public class ChannelIndex : Entitas.Gentitas.Index<int, StateEntity>, IChannelIndex
        {
            IGroup<StateEntity> groupToWatch;

            public ChannelIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.Channel));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~ChannelIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasChannel() ;
            }

            void Remove(StateEntity entity, int value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, int value)
            {
                if (entity.HasChannel()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, int value, int previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Channel)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Channel)component).value, ((Components.State.Channel)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.Channel)component).value);
            }

            public StateEntity FindSingle(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.ChannelIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(int value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface IConfigIdIndex {
            /// Value: ConfigId  
            StateEntity FindSingle(string value);
            /// Value: ConfigId  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class ConfigIdIndex : Entitas.Gentitas.Index<string, StateEntity>, IConfigIdIndex
        {
            IGroup<StateEntity> groupToWatch;

            public ConfigIdIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.ConfigId));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~ConfigIdIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasConfigId() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasConfigId()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ConfigId)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ConfigId)component).value, ((Components.State.ConfigId)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ConfigId)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.ConfigIdIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface IMenuButtonIdIndex {
            /// Value: MenuButtonId  
            StateEntity FindSingle(string value);
            /// Value: MenuButtonId  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class MenuButtonIdIndex : Entitas.Gentitas.Index<string, StateEntity>, IMenuButtonIdIndex
        {
            IGroup<StateEntity> groupToWatch;

            public MenuButtonIdIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.MenuButtonId));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~MenuButtonIdIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasMenuButtonId() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasMenuButtonId()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.MenuButtonId)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.MenuButtonId)component).value, ((Components.State.MenuButtonId)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.MenuButtonId)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.MenuButtonIdIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface ILigthIdIndex {
            /// Value: LigthId  
            StateEntity FindSingle(string value);
            /// Value: LigthId  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class LigthIdIndex : Entitas.Gentitas.Index<string, StateEntity>, ILigthIdIndex
        {
            IGroup<StateEntity> groupToWatch;

            public LigthIdIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.LigthId));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~LigthIdIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasLigthId() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasLigthId()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LigthId)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LigthId)component).value, ((Components.State.LigthId)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.LigthId)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.LigthIdIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
        public interface IModalIdIndex {
            /// Value: ModalId  
            StateEntity FindSingle(string value);
            /// Value: ModalId  
            HashSet<StateEntity> Find(string value);
            int GetCount(string value);
        }

        public class ModalIdIndex : Entitas.Gentitas.Index<string, StateEntity>, IModalIdIndex
        {
            IGroup<StateEntity> groupToWatch;

            public ModalIdIndex(StateContext context) : base()
            {
                groupToWatch = context.GetGroup(Matcher<StateEntity>.AllOf(StateMatcher.ModalId));
                groupToWatch.OnEntityAdded += Added;
                groupToWatch.OnEntityUpdated += Updated;
                groupToWatch.OnEntityRemoved += Removed;
            }

            ~ModalIdIndex () {
                groupToWatch.OnEntityAdded -= Added;
                groupToWatch.OnEntityUpdated -= Updated;
                groupToWatch.OnEntityRemoved -= Removed;
            }

            protected override bool Filter(StateEntity entity)
            {
                return entity.HasModalId() ;
            }

            void Remove(StateEntity entity, string value) {
                if (lookup.ContainsKey(value))
                {
                    var list = lookup[value];
                    if (list.Contains(entity)) list.Remove(entity);
                }
            }

            void HandleEntity(StateEntity entity, string value)
            {
                if (entity.HasModalId()) {
                    if (Filter(entity))
                    {
                        HashSet<StateEntity> result;
                        lookup.TryGetValue(value, out result);
                        if (result == null) {
                            result = new HashSet<StateEntity>();
                            lookup.Add(value, result);
                            result.Add(entity);
                        } else {
                            if (!result.Contains(entity)) result.Add(entity);
                        }
                    }
                    else
                    {
                        Remove(entity, value);
                    }
                } else {
                    Remove(entity, value);
                }
            }

            void HandleEntity(StateEntity entity, string value, string previousValue)
            {
                if (value != previousValue)
                {
                    Remove(entity, previousValue);
                }
                
                HandleEntity(entity, value);
            }

            void Added(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ModalId)component).value);
            }

            void Updated(IGroup<StateEntity> group, StateEntity entity, int index, IComponent previousComponent, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ModalId)component).value, ((Components.State.ModalId)previousComponent).value);
            }

            void Removed(IGroup<StateEntity> group, StateEntity entity, int index, IComponent component)
            {
                HandleEntity(entity, ((Components.State.ModalId)component).value);
            }

            public StateEntity FindSingle(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null || result.Count == 0) return null;
                if (result.Count > 1) {
                    UnityEngine.Debug.LogError("DZ.Game.ModalIdIndex has more than 1 entity with value " + value);
                    return null;
                }
                
                var enumarator = result.GetEnumerator();
                enumarator.MoveNext();
                
                return enumarator.Current;
            }

            public HashSet<StateEntity> Find(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) {
                    result = lookup[value] = new HashSet<StateEntity>();
                }

                return result;
            }

            public int GetCount(string value)
            {
                HashSet<StateEntity> result;
                lookup.TryGetValue(value, out result);

                if (result == null) return 0;
                return result.Count;
            }
        }
	}
}
